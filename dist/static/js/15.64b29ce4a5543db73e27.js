webpackJsonp([15],{"8VBO":function(t,e){},vdVF:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("g5J/");var a=s("6lib"),i=s("9vbe"),o=s("bbS5"),n=(i.default,o.default,{name:"Login",components:{UserAgreement:i.default,PrivacyAgreement:o.default},data:function(){return{mobile:"",password:"",errorMsg:"",toastTip:!1,isActive:!1,agreement1:!1,agreement2:!1,isShow:1,isSel:!1}},methods:{agreementClick:function(){this.isSel=!this.isSel},agreement1IsShow:function(){this.agreement1=!0,this.isShow=2},agreement1Close:function(){this.agreement1=!1,this.isShow=1},agreement2IsShow:function(){this.agreement2=!0,this.isShow=2},agreement2Close:function(){this.agreement2=!1,this.isShow=1},validMobile:function(){11==this.mobile.length&&/^1[3|4|5|7|8|9|6]\d{9}$/.test(this.mobile)&&this.password.length>=6?this.isActive=!0:this.isActive=!1,a.a.setStore("temMobile",this.mobile),console.log(a.a.getStore("temMobile"))},tipShow:function(t){this.errorMsg=t,this.toastTip=!0;var e=this;setTimeout(function(){return e.toastTip=!1,!1},2e3)},getLoginData:function(){var t=this;if(this.isActive){if(""==this.mobile&&""==this.password)return console.log("手机号或者密码不能为空"),!1;this.$http.post(this.baseurl+"/login",{mobile:this.mobile,password:this.password}).then(function(e){t.tipShow("登录成功");var s=e.data.data;a.a.setCookie("accountId",s.account_id),a.a.setCookie("mobile",t.mobile),a.a.setCookie("accesstoken",s.access_token),a.a.setCookie("uid",s.nim_id),a.a.setCookie("sdktoken",s.nim_token),"session"==a.a.getStore("tempUrl")?t.getSessionId(s.nim_id,t.mobile,s.account_id):"session"!=a.a.getStore("tempUrl")&&""!=a.a.getStore("tempUrl")&&a.a.getStore("tempUrl")?t.$router.push({path:a.a.getStore("tempUrl")}):t.$router.push({path:"/"})}).catch(function(e){console.log(e),e.response&&(console.log(e.response.data.message),t.tipShow(e.response.data.message))})}},getSessionId:function(t,e,s){var i=this,o={params:{customerIM:t,customerPhone:e}};this.$http.post(this.baseurl+"/im/getimaccount",o).then(function(t){if(200==t.data.code){var e=t.data.data;i.sessionId=a.a.setCookie("sessionId",e),i.getAccountId(s)}})},getAccountId:function(t){var e=this,s={params:{accountId:t}};this.$http.post(this.baseurl+"/im/notice",s).then(function(t){if(200==t.data.code){e.accountMsg=t.data.data;t.data.data.sendTime;a.a.setCookie("sendTime",t.data.data.sendTime);t.data.data.readStatus;a.a.setCookie("readStatus",t.data.data.readStatus);t.data.data.msgDetails;a.a.setCookie("msgDetails",t.data.data.msgDetails),a.a.setCookie("accountMsg",e.accountMsg),window.location.href="http://"+window.location.hostname+"/im.html#/session"}})}},beforeRouteEnter:function(t,e,s){"/login"==e.path||"/register"==e.path||"/messagelogin"==e.path||"/forgetpassword"==e.path?a.a.setStore("tempUrl",a.a.getStore("tempUrl")):"/"==e.path&&"home"!=e.name?a.a.setStore("tempUrl","session"):a.a.setStore("tempUrl",e.fullPath),s()}}),r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:1==t.isShow,expression:"isShow==1"}],staticClass:"login"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.toastTip,expression:"toastTip"}],staticClass:"toast-tip"},[t._v("\n    "+t._s(t.errorMsg)+"\n  ")]),t._v(" "),s("div",{staticClass:"header line-bottom"},[s("span",{staticClass:"icon-close",on:{click:function(e){t.$router.go(-1)}}}),t._v("\n    账号登录\n  ")]),t._v(" "),t._m(0),t._v(" "),s("div",{staticClass:"form-frame"},[s("div",{staticClass:"from-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.mobile,expression:"mobile"}],staticClass:"input1 tel1",attrs:{type:"tel",placeholder:"手机号",maxlength:"11"},domProps:{value:t.mobile},on:{input:[function(e){e.target.composing||(t.mobile=e.target.value)},t.validMobile]}}),t._v(" "),t._m(1)]),t._v(" "),s("div",{staticClass:"from-input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"input1 password1",attrs:{type:"password",placeholder:"密  码"},domProps:{value:t.password},on:{input:[function(e){e.target.composing||(t.password=e.target.value)},t.validMobile]}}),t._v(" "),t._m(2),t._v(" "),s("router-link",{staticClass:"forgetPw",attrs:{tag:"span",to:"forgetpassword"}},[t._v("忘记密码")])],1),t._v(" "),s("div",{staticClass:"messageLoginBtn"},[s("router-link",{attrs:{tag:"a",to:"/messagelogin"}},[t._v("手机快捷登录")])],1),t._v(" "),s("div",{staticClass:"btnLogin",class:{activeState:t.isActive},on:{click:t.getLoginData}},[t._v("登录")]),t._v(" "),s("router-link",{staticClass:"btnRegister",attrs:{tag:"div",to:"/register"}},[t._v("注册")]),t._v(" "),s("div",{staticClass:"agreement"},[t._v("\n      注册/登录即代表同意商机盒子的"),s("a",{attrs:{href:"javascript:void(0)"},on:{click:t.agreement1IsShow}},[t._v("《用户协议》")]),t._v("和"),s("a",{on:{click:t.agreement2IsShow}},[t._v("《隐私协议》")])])],1)]),t._v(" "),s("user-agreement",{attrs:{agreement1:t.agreement1},on:{"child-msg1":t.agreement1Close}}),t._v(" "),s("privacy-agreement",{attrs:{agreement2:t.agreement2},on:{"child-msg2":t.agreement2Close}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"logoImg"},[e("img",{attrs:{src:"/static/images/home/bg_shangjihezilogo@3x.png"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"icon-tel iconImg"},[e("img",{attrs:{src:"/static/images/home/icon/icon_phone@3x.png"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"icon-passw iconImg"},[e("img",{attrs:{src:"/static/images/home/icon/icon_lock@3x.png"}})])}]};var c=s("VU/8")(n,r,!1,function(t){s("8VBO")},"data-v-99a705ac",null);e.default=c.exports}});
//# sourceMappingURL=15.64b29ce4a5543db73e27.js.map